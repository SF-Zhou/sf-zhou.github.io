# Fio Examples

### 1. Write

Minimal exmaple:

```bash
fio --name=test --rw=write --size=1M
#> test: (g=0): rw=write, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=psync, iodepth=1
#> fio-3.16
#> Starting 1 process
#> test: Laying out IO file (1 file / 1MiB)
#>
#> test: (groupid=0, jobs=1): err= 0: pid=2647: Tue Mar 15 14:45:39 2022
#>   write: IOPS=85.3k, BW=333MiB/s (350MB/s)(1024KiB/3msec); 0 zone resets
#>     clat (usec): min=6, max=211, avg= 7.98, stdev=12.93
#>      lat (usec): min=6, max=212, avg= 8.05, stdev=13.00
#>     clat percentiles (usec):
#>      |  1.00th=[    7],  5.00th=[    7], 10.00th=[    7], 20.00th=[    7],
#>      | 30.00th=[    7], 40.00th=[    7], 50.00th=[    7], 60.00th=[    7],
#>      | 70.00th=[    7], 80.00th=[    7], 90.00th=[    8], 95.00th=[   14],
#>      | 99.00th=[   21], 99.50th=[   23], 99.90th=[  212], 99.95th=[  212],
#>      | 99.99th=[  212]
#>   lat (usec)   : 10=93.75%, 20=5.47%, 50=0.39%, 250=0.39%
#>   cpu          : usr=0.00%, sys=750.00%, ctx=0, majf=0, minf=30
#>   IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%
#>      submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
#>      complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
#>      issued rwts: total=0,256,0,0 short=0,0,0,0 dropped=0,0,0,0
#>      latency   : target=0, window=0, percentile=100.00%, depth=1
#>
#> Run status group 0 (all jobs):
#>   WRITE: bw=333MiB/s (350MB/s), 333MiB/s-333MiB/s (350MB/s-350MB/s), io=1024KiB (1049kB), run=3-3msec

ls -l
#> total 1.0M
#> -rw-r--r-- 1 zsf zsf 1.0M Mar 15 14:45 test.0.0
```

Create multiple files:

```bash
fio --name=test --group_reporting --directory=/tmp/test --ioengine=psync --rw=write --direct=1 --bs=1M --size=1G --numjobs=8
#> test: (g=0): rw=write, bs=(R) 1024KiB-1024KiB, (W) 1024KiB-1024KiB, (T) 1024KiB-1024KiB, ioengine=psync, iodepth=1
#> ...
#> fio-3.16
#> Starting 8 processes
#> test: Laying out IO file (1 file / 1024MiB)
#> test: Laying out IO file (1 file / 1024MiB)
#> test: Laying out IO file (1 file / 1024MiB)
#> test: Laying out IO file (1 file / 1024MiB)
#> test: Laying out IO file (1 file / 1024MiB)
#> test: Laying out IO file (1 file / 1024MiB)
#> test: Laying out IO file (1 file / 1024MiB)
#> test: Laying out IO file (1 file / 1024MiB)
#>
#> test: (groupid=0, jobs=8): err= 0: pid=3554: Tue Mar 15 14:57:10 2022
#>   write: IOPS=1204, BW=1204MiB/s (1263MB/s)(8192MiB/6803msec); 0 zone resets
#>     clat (usec): min=639, max=33284, avg=6602.69, stdev=2407.47
#>      lat (usec): min=647, max=33310, avg=6629.95, stdev=2407.33
#>     clat percentiles (usec):
#>      |  1.00th=[ 1270],  5.00th=[ 1483], 10.00th=[ 1893], 20.00th=[ 5866],
#>      | 30.00th=[ 6325], 40.00th=[ 6718], 50.00th=[ 7046], 60.00th=[ 7308],
#>      | 70.00th=[ 7570], 80.00th=[ 7832], 90.00th=[ 8225], 95.00th=[ 8586],
#>      | 99.00th=[10421], 99.50th=[14877], 99.90th=[26084], 99.95th=[27395],
#>      | 99.99th=[33162]
#>    bw (  MiB/s): min=  990, max= 2535, per=98.95%, avg=1191.57, stdev=49.14, samples=104
#>    iops        : min=  986, max= 2530, avg=1186.85, stdev=49.11, samples=104
#>   lat (usec)   : 750=0.28%, 1000=0.21%
#>   lat (msec)   : 2=9.78%, 4=0.99%, 10=87.48%, 20=0.78%, 50=0.49%
#>   cpu          : usr=0.45%, sys=9.97%, ctx=0, majf=0, minf=238
#>   IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%
#>      submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
#>      complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
#>      issued rwts: total=0,8192,0,0 short=0,0,0,0 dropped=0,0,0,0
#>      latency   : target=0, window=0, percentile=100.00%, depth=1
#>
#> Run status group 0 (all jobs):
#>   WRITE: bw=1204MiB/s (1263MB/s), 1204MiB/s-1204MiB/s (1263MB/s-1263MB/s), io=8192MiB (8590MB), run=6803-6803msec

ls -l /tmp/test
#> total 8.0G
#> -rw-r--r-- 1 zsf zsf 1.0G Mar 15 14:57 test.0.0
#> -rw-r--r-- 1 zsf zsf 1.0G Mar 15 14:57 test.1.0
#> -rw-r--r-- 1 zsf zsf 1.0G Mar 15 14:57 test.2.0
#> -rw-r--r-- 1 zsf zsf 1.0G Mar 15 14:57 test.3.0
#> -rw-r--r-- 1 zsf zsf 1.0G Mar 15 14:57 test.4.0
#> -rw-r--r-- 1 zsf zsf 1.0G Mar 15 14:57 test.5.0
#> -rw-r--r-- 1 zsf zsf 1.0G Mar 15 14:57 test.6.0
#> -rw-r--r-- 1 zsf zsf 1.0G Mar 15 14:57 test.7.0
```

Write for a while:

```bash
fio --name=test --group_reporting --opendir=/tmp/test --ioengine=psync --rw=write --direct=1 --bs=1M --runtime=60 --numjobs=8
#> fio: opendir added 8 files
#> test: (g=0): rw=write, bs=(R) 1024KiB-1024KiB, (W) 1024KiB-1024KiB, (T) 1024KiB-1024KiB, ioengine=psync, iodepth=1
#> ...
#> fio-3.16
#> Starting 8 processes
#>
#> test: (groupid=0, jobs=8): err= 0: pid=3696: Tue Mar 15 15:02:47 2022
#>   write: IOPS=4517, BW=4518MiB/s (4737MB/s)(64.0GiB/14506msec); 0 zone resets
#>     clat (usec): min=217, max=22752, avg=1715.98, stdev=1081.36
#>      lat (usec): min=239, max=22775, avg=1749.85, stdev=1085.12
#>     clat percentiles (usec):
#>      |  1.00th=[  474],  5.00th=[  971], 10.00th=[ 1090], 20.00th=[ 1188],
#>      | 30.00th=[ 1270], 40.00th=[ 1352], 50.00th=[ 1434], 60.00th=[ 1549],
#>      | 70.00th=[ 1696], 80.00th=[ 1958], 90.00th=[ 2540], 95.00th=[ 3359],
#>      | 99.00th=[ 6521], 99.50th=[ 8029], 99.90th=[12387], 99.95th=[14222],
#>      | 99.99th=[19792]
#>    bw (  MiB/s): min= 3380, max= 5836, per=98.18%, avg=4435.82, stdev=78.74, samples=225
#>    iops        : min= 3376, max= 5833, avg=4431.92, stdev=78.70, samples=225
#>   lat (usec)   : 250=0.01%, 500=1.20%, 750=1.34%, 1000=3.19%
#>   lat (msec)   : 2=75.39%, 4=15.54%, 10=3.10%, 20=0.22%, 50=0.01%
#>   cpu          : usr=2.06%, sys=64.11%, ctx=0, majf=0, minf=276
#>   IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%
#>      submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
#>      complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
#>      issued rwts: total=0,65536,0,0 short=0,0,0,0 dropped=0,0,0,0
#>      latency   : target=0, window=0, percentile=100.00%, depth=1
#>
#> Run status group 0 (all jobs):
#>   WRITE: bw=4518MiB/s (4737MB/s), 4518MiB/s-4518MiB/s (4737MB/s-4737MB/s), io=64.0GiB (68.7GB), run=14506-14506msec
```
