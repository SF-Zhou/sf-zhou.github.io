# æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•

æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼ˆLagrange Multipliersï¼‰ï¼Œå¯ä»¥å°†æœ‰ $d$ ä¸ªå˜é‡ä¸ $k$ ä¸ªçº¦æŸæ¡ä»¶çš„æœ€ä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºå…·æœ‰ $d+k$ ä¸ªå˜é‡çš„æ— çº¦æŸä¼˜åŒ–é—®é¢˜ã€‚

### ä¸€ã€ç®€å•æƒ…å†µ

$$
\begin{aligned}
& \min_{\boldsymbol x} && f(\boldsymbol x) \\
& \textrm{s.t.} && g(\boldsymbol x) = 0
\end{aligned}
$$

ä»å‡ ä½•è§’åº¦çœ‹ï¼Œè¯¥é—®é¢˜çš„ç›®æ ‡æ˜¯åœ¨æ–¹ç¨‹ $g(\boldsymbol x) = 0$ ç¡®å®šçš„ $d-1$ ç»´æ›²é¢ä¸Šå¯»æ‰¾èƒ½ä½¿ç›®æ ‡å‡½æ•° $f(\boldsymbol x)$ æœ€å°åŒ–çš„ç‚¹ï¼Œæ­¤æ—¶ï¼š

1. å¯¹äºçº¦æŸæ›²é¢ä¸Šçš„ä»»ä¸€ç‚¹ $\boldsymbol x$ï¼Œè¯¥ç‚¹çš„æ¢¯åº¦ $\nabla g(\boldsymbol x)$ æ­£äº¤äºçº¦æŸå¹³é¢
2. åœ¨æœ€ä¼˜ç‚¹ $\boldsymbol x^*$ï¼Œç›®æ ‡å‡½æ•°åœ¨è¯¥ç‚¹çš„æ¢¯åº¦ $\nabla f(\boldsymbol x)$ æ­£äº¤äºçº¦æŸå¹³é¢ã€‚

ä¸Šè¿°æ¡ä»¶å³å‡½æ•°ç­‰å€¼çº¿ä¸çº¦æŸæ›²é¢ç›¸åˆ‡ï¼Œå¯é€šè¿‡åè¯æ³•è¯æ˜ï¼šè‹¥æ¢¯åº¦ $\nabla f(\boldsymbol x^*)$ ä¸çº¦æŸæ›²é¢ä¸æ­£äº¤ï¼Œåˆ™ä»å¯åœ¨çº¦æŸæ›²é¢ä¸Šç§»åŠ¨è¯¥ç‚¹ä½¿å‡½æ•°å€¼è¿›ä¸€æ­¥ä¸‹é™ã€‚

ç”±æ­¤å¯çŸ¥ï¼Œåœ¨æœ€ä¼˜ç‚¹ $\boldsymbol x^*$ï¼Œæ¢¯åº¦ $\nabla g(\boldsymbol x)$ å’Œ $\nabla f(\boldsymbol x)$ çš„æ–¹å‘ç›¸åŒæˆ–ç›¸åï¼Œå³å­˜åœ¨ $\lambda \neq 0$ ä½¿å¾—ï¼š

$$
\nabla f(\boldsymbol x^*) + \lambda \nabla g(\boldsymbol x^*) = 0
$$

$\lambda$ ç§°ä¸ºæ‹‰æ ¼æœ—æ—¥ä¹˜å­ã€‚å®šä¹‰æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š

$$
L(\boldsymbol x, \lambda) = f(\boldsymbol x) + \lambda g(\boldsymbol x)
$$

å½“å‡½æ•° $L(\boldsymbol x, \lambda)$ çš„ [Jacobian çŸ©é˜µ](https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant) $J_L = \boldsymbol 0$ æ—¶ï¼Œçº¦æŸæ¡ä»¶å’Œæ¢¯åº¦æ¡ä»¶åŒæ—¶æ»¡è¶³ã€‚äºæ˜¯ï¼ŒåŸçº¦æŸä¼˜åŒ–é—®é¢˜å¯è½¬åŒ–ä¸ºå¯¹æ‹‰æ ¼æœ—æ—¥å‡½æ•° $L(\boldsymbol x, \lambda)$ çš„æ— çº¦æŸä¼˜åŒ–é—®é¢˜ã€‚

ä¸¾ä¸ªä¾‹å­ğŸŒ°ï¼Œæ±‚æ¤­åœ† $\frac {x^2}{4} + \frac {y^2}{3} = 1$ ä¸Šåˆ°ç‚¹ $(1, 1)$ çš„æœ€çŸ­è·ç¦»çš„å¹³æ–¹ï¼Œå³ï¼š

$$
\begin{aligned}
& \min_{x, y} && f(x, y) = {(x - 1)^2+(y - 1)^2} \\
& \textrm{s.t.} && g(x, y) = \frac {x^2}{4} + \frac {y^2}{3} - 1 = 0
\end{aligned}
$$

è§£ï¼šå®šä¹‰æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š

$$
L(x, y, \lambda) = f(x, y) + \lambda g(x, y)
$$

å¯¹åº”çš„ Jacobian çŸ©é˜µä¸ºï¼š

$$
J_L = \left [ 2(x - 1)+\frac {\lambda} {2}x, 2(y - 1)+\frac {2\lambda }{3}y, \frac {x^2}{4} + \frac {y^2}{3} - 1 \right ]^T = \boldsymbol 0
$$

å¯å¾—ï¼š

$$
\lambda = 4(\frac 1 x - 1) = 3(\frac 1 y - 1)
$$

å¯å¾—ï¼š

$$
y = \frac {3x} {4 - x}
$$

å¯å¾—ï¼š

$$
\frac {x^2} {4} + \frac {3x^2} {(4 - x)^2} = 1
$$

å¯å¾—ï¼š

$$
x^4 - 8x^3 + 24 x^2 + 32x - 64 = 0
$$

æ ¹æ®[å››æ¬¡æ–¹ç¨‹æ±‚æ ¹å…¬å¼](https://zh.wikipedia.org/wiki/%E5%9B%9B%E6%AC%A1%E6%96%B9%E7%A8%8B#%E6%B1%82%E6%A0%B9%E5%85%AC%E5%BC%8F)ï¼Œå¯è§£å¾— $x_1 \approx 1.24, x_2 \approx -1.71$ã€‚

æ˜“çŸ¥ $x > 0, y > 0$ï¼Œæœ€ç»ˆå¯æ±‚å¾— $x \approx 1.24, y \approx 1.36, \min f(x, y) \approx 0.19$ã€‚

> ä¸Šé¢è¿™é“é¢˜ç›®æ˜¯ç¬”è€…é«˜ä¸­çš„æ—¶å€™æƒ³åˆ°å´ä¸ä¼šè§£å†³çš„é—®é¢˜ã€‚åæ¥å¤§ä¸€çš„ã€Šå·¥ç§‘æ•°å­¦åˆ†æã€‹è¯¾ç¨‹ä¸­æœ‰æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼Œå´æ²¡æœ‰å¥½å¥½å­¦ä¹ ï¼Œå®åœ¨æƒ­æ„§ã€‚

### äºŒã€ä¸ç­‰å¼çº¦æŸ

$$
\begin{aligned}
& \min_{\boldsymbol x} && f(\boldsymbol x) \\
& \textrm{s.t.} && g(\boldsymbol x) \le 0
\end{aligned}
$$

æ­¤æ—¶æœ€ä¼˜ç‚¹ $\boldsymbol x^*$ æˆ–åœ¨ $\nabla g(\boldsymbol x) < 0$ çš„åŒºåŸŸä¸­ï¼Œå¯ç›´æ¥é€šè¿‡æ¡ä»¶ $\nabla f(\boldsymbol x) = 0$ æ±‚è§£ï¼Œç­‰ä»·äºå°† $\lambda$ ç½®é›¶åå¯¹ $\nabla _{\boldsymbol x} L(\boldsymbol x, \lambda)$ ç½®é›¶å¾—åˆ°æœ€ä¼˜ç‚¹ï¼›æˆ–åœ¨è¾¹ç•Œ $\nabla g(\boldsymbol x) = 0$ ä¸Šï¼Œæ­¤æ—¶ $\nabla f(\boldsymbol x^*)$ çš„æ–¹å‘å¿…ä¸ $\nabla g(\boldsymbol x^*)$ ç›¸åï¼Œ$\lambda > 0$ã€‚

æ•´åˆè¿™ä¸¤ç§æƒ…å½¢ï¼Œå¿…æ»¡è¶³ $\lambda \nabla g(\boldsymbol x) = 0$ã€‚å› æ­¤åœ¨çº¦æŸ $g(\boldsymbol x) \le 0$ ä¸‹æœ€å°åŒ– $f(\boldsymbol x)$ï¼Œå¯è½¬åŒ–ä¸ºåœ¨å¦‚ä¸‹çº¦æŸä¸‹æœ€å°åŒ– $L(\boldsymbol x, \lambda)$ çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š

$$
\begin{cases}
g(\boldsymbol x) \le 0 \\
\lambda \ge 0  \\
\lambda g(\boldsymbol x) = 0
\end{cases}
$$

ä¸Šå¼ç§°ä¸º [Karush-Kuhn-Tuckerï¼ˆ`KTT`ï¼‰æ¡ä»¶](https://en.wikipedia.org/wiki/Karush%E2%80%93Kuhn%E2%80%93Tucker_conditions)ã€‚KKT æ¡ä»¶æ˜¯åŸé—®é¢˜æ±‚è§£çš„å¿…è¦æ¡ä»¶ã€‚å…·ä½“æ±‚è§£è¿‡ç¨‹ä¸­å¯ä»¥åˆ†æƒ…å†µè®¨è®ºä¸ç­‰å¼çº¦æŸæ˜¯å¦æœ‰æ•ˆã€‚

ä¾ç„¶ä¸¾ä¸ªä¾‹å­ğŸŒ°ï¼š

$$
\begin{aligned}
& \min_{x, y} && f(x, y) = {(x - 1)^2+(y - 1)^2} \\
& \textrm{s.t.} && g(x, y) = \frac {x^2}{4} + \frac {y^2}{3} - 1 <= 0
\end{aligned}
$$

è§£ï¼šå®šä¹‰æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š

$$
L(x, y, \lambda) = f(x, y) + \lambda g(x, y)
$$

KKT æ¡ä»¶ä¸ºï¼š

$$
\begin{cases}
g(x, y) \le 0 \\
\lambda \ge 0  \\
\lambda g(x, y) = 0
\end{cases}
$$

è‹¥ $g(x, y) = 0$ï¼Œåˆ™ç±»ä¼¼ç®€å•æƒ…å†µæ±‚è§£ï¼Œä¸å†èµ˜è¿°ï¼›è‹¥ $g(x, y) < 0$ï¼Œåˆ™ $\lambda = 0$ï¼Œæ˜“çŸ¥ï¼š

$$
\begin{aligned}
\nabla_x L(x, y, \lambda) &= 2(x - 1) = 0\\
\nabla_y L(x, y, \lambda) &= 2(y - 1) = 0
\end{aligned}
$$

ç”±ä¸Šå¼æ˜“å¾— $x = 1, y = 1$ï¼Œ$f(x, y) = 0$ã€‚æ­¤æ—¶ $g(x, y) < 0$ï¼Œæ¡ä»¶æ»¡è¶³ã€‚

å¯¹æ¯”å¯å¾— $x = 1, y = 1$ æ—¶ $f(x, y)$ ä¸ºæœ€ä¼˜è§£ã€‚

### å‚è€ƒæ–‡çŒ®

1. å‘¨å¿—å. "æœºå™¨å­¦ä¹ ." æ¸…åå¤§å­¦å‡ºç‰ˆç¤¾ï¼ŒåŒ—äº¬.
2. ["Lagrange multiplier." ç»´åŸºç™¾ç§‘.](https://en.wikipedia.org/wiki/Lagrange_multiplier)
3. ["Karush-Kuhn-Tucker conditions." ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Karush%E2%80%93Kuhn%E2%80%93Tucker_conditions)

